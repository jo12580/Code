C51 COMPILER V9.01   MAIN                                                                  04/26/2021 21:32:26 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN main.OBJ
COMPILER INVOKED BY: D:\Software\Keil\32\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\List
                    -ings\main.lst) TABS(2)

line level    source

   1          #include <STC15F2K60S2.H>
   2          
   3          unsigned int smgduan[19]={ 0xC0, 0xF9, 0xA4, 0xB0, 0x99, 0x92, 0x82, 0xF8, 0x80, 0x90, 0x88, 
   4          0x83, 0xC6, 0xA1, 0x86, 0x8E, 0xBF, 0x7F };
   5          //0、1、2、3、4、5、6、7、8、9、A、b、C、d、E、F、H的显示码
   6          unsigned char DisplayData[8];
   7          static unsigned int a=10000,b=0;
   8          
   9          void datapros();
  10          void display();
  11          
  12          void delay(unsigned int c)
  13          {
  14   1        while(c--);
  15   1      }
  16          
  17          void Timer0Init()   //100微秒@11.0592MHz
  18          {
  19   1        AUXR |= 0x80;   //定时器时钟1T模式
  20   1        TMOD &= 0xF0;   //设置定时器模式
  21   1        TL0 = 0xCD;   //设置定时初值
  22   1        TH0 = 0xD4;   //设置定时初值
  23   1        TF0 = 0;    //清除TF0标志
  24   1        TR0 = 1;    //定时器0开始计时
  25   1        EA=1;
  26   1        ET0=1;
  27   1      }
  28          
  29          void main()
  30          {
  31   1        Timer0Init();
  32   1        while(1)
  33   1        {
  34   2          display();
  35   2          delay(100);
  36   2        }
  37   1      }
  38          
  39          void Timer0() interrupt 1
  40          {
  41   1        unsigned int i;
  42   1        TL0 = 0xCD;   //设置定时初值
  43   1        TH0 = 0xD4;   //设置定时初值
  44   1        i++;
  45   1        if(i==1000)
  46   1        {
  47   2          a--;
  48   2          b++;
  49   2          i=0;
  50   2        }
  51   1      }
  52          
  53          void datapros()    //时间读取处理转换函数
  54          {
C51 COMPILER V9.01   MAIN                                                                  04/26/2021 21:32:26 PAGE 2   

  55   1        DisplayData[0]=smgduan[a/1000%10];
  56   1        DisplayData[1]=smgduan[a/100%10];
  57   1        DisplayData[2]=smgduan[a/10%10];
  58   1        DisplayData[3]=smgduan[a%10];
  59   1        
  60   1        DisplayData[4]=smgduan[b/1000%10];
  61   1        DisplayData[5]=smgduan[b/100%10];
  62   1        DisplayData[6]=smgduan[b/10%10];
  63   1        DisplayData[7]=smgduan[b%10];
  64   1      }
  65          
  66          void display()
  67          {
  68   1        unsigned int i;
  69   1        datapros() ;
  70   1        for(i=0;i<=7;i++)
  71   1        {
  72   2          P2=0xc0;
  73   2          switch(i)
  74   2          {
  75   3            case 0:P0=0x01;break;
  76   3            case 1:P0=0x02;break;
  77   3            case 2:P0=0x04;break;
  78   3            case 3:P0=0x08;break;
  79   3            case 4:P0=0x10;break;
  80   3            case 5:P0=0x20;break;
  81   3            case 6:P0=0x40;break;
  82   3            case 7:P0=0x80;break;
  83   3          }
  84   2          P2=0xe0;
  85   2          P0= DisplayData[i];
  86   2          delay(100); 
  87   2          P0=0xff;
  88   2        }
  89   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    430    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     50       2
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
